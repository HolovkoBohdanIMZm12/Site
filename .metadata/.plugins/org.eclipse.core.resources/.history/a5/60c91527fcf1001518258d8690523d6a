package com.Sck;

import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

public class Main {

	public static void main(String[] args) 
	{
		
		BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
		
		
		//============
		
		String arr1[];
		String arr2[][];
		String str = null;	
		
		Implementation imp;
						
		//============
		
						
		System.out.println("Welcome to simple java console interprate."
				 		 + "Select the appropriate command:\n" 
				 		 + "Press 'ping' to selest the command: ping" 
				 		 + "\nPress 'echo' to selest the command: echo" 
				 		 + "\nPress 'login' to selest the command: login: <login name>, <login password>" 
				 		 + "\nPress 'list' to selest the command: list"
						 + "\nPress 'msg' to selest the command: msg: <name of the msg>, <text of the msg>"
						 + "\nPress 'file' to selest the command: file: <username>, <filename>"
						 + "\nPress 'exit' to selest the command: exit");
		
		//============
		
		System.out.println();
		System.out.println("\nEnter the command: ");
		
		//============
		
		try
		{		
			do
			{
				str = reader.readLine();
				arr1 = str.split(", ");
				switch (arr1[0]) 
				{
			    	case "ping": 	imp.ping(socket);  break;
			        case "echo": 	imp.echo(socket,String.join(" ", partsout(arr1,1)));  break;
			        
//			        case "login": 	System.out.println("You entered command: Login: <login name: " + arr1[1] + ">; <password: " + arr1[2] + ">");  break;
//			        case "list": 	System.out.println("You entered command: List");  break;
//			        case "msg": 	System.out.println("You entered command: Msg: <name of the msg: " + arr1[1] + ">; <Text of the msg: " + String.join(" ", partsout(arr1,2)) + ">");  break;
//			        case "file":  	System.out.println("You entered command: File: <username: " + arr1[1] + ">; <filename: " + arr1[2] + ">");  break;
//			        case "exit":  	System.exit(13);  break;
			        default: 		System.out.println("Incorrect command! Try again.");  break;
				}
			}	
			while((str = reader.readLine ()) != null);
		}
		catch(ArrayIndexOutOfBoundsException aobe)
		{
			System.out.println("ArrayIndexOutOfBoundsException!");
		}
		catch(Exception exc)
		{
			System.out.println("Exception!");
		}
		
		
	}
			
	//================
	
		static String[] partsout(String[] array, int index)
		{
			String [] result = new String[array.length-index];
			for (int i=index; i<(array.length); i++)
			{
				result[i-index] = array[i];
			}
			return result;
		}
	
		static byte[] serialize(Object obj) throws IOException 
		{
		    ByteArrayOutputStream out = new ByteArrayOutputStream();
		    ObjectOutputStream os = new ObjectOutputStream(out);
		    os.writeObject(obj);
		    return out.toByteArray();
		}
		
		static Object deserialize(byte[] data) throws IOException, ClassNotFoundException 
		{
		    ByteArrayInputStream in = new ByteArrayInputStream(data);
		    ObjectInputStream is = new ObjectInputStream(in);
		    return is.readObject();
		}

}
